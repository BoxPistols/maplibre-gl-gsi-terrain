# ドローン飛行シミュレーター - ユーザーマニュアル

## 📋 目次

1. [はじめに](#はじめに)
2. [基本操作](#基本操作)
3. [フライトプランの使い方](#フライトプランの使い方)
4. [リアルタイムログ](#リアルタイムログ)
5. [高度な機能](#高度な機能)
6. [トラブルシューティング](#トラブルシューティング)

---

## はじめに

### 🚁 このアプリケーションについて

ドローン飛行シミュレーターは、国土地理院の3D地形データを使用して、ドローンの飛行計画を視覚化・実行できるWebアプリケーションです。

### ✨ 主な機能

- **3D地形表示**: 日本全国の詳細な3D地形データ
- **フライトプラン実行**: 事前に計画した飛行経路を自動実行
- **FPV視点**: ドローンの目線で飛行を体験
- **Waypoint可視化**: 飛行経路とウェイポイントを明確に表示
- **リアルタイムログ**: 飛行状況を逐次記録・表示

---

## 基本操作

### 🗺️ 地図の操作

| 操作 | 方法 |
|------|------|
| **パン（移動）** | 左クリック + ドラッグ |
| **ズーム** | マウスホイール / ピンチ |
| **回転** | 右クリック + ドラッグ |
| **傾き（ピッチ）** | Ctrl + 左クリック + ドラッグ |

### 🎮 2D/3D切り替え

画面左側のコントロールパネルにある「2D/3D」ボタンをクリックすると、表示モードを切り替えられます。

---

## フライトプランの使い方

### 📍 フライトプランの選択

1. **画面右側のパネル**を開く（「プラン」タブをクリック）
2. **ドロップダウンメニュー**から目的地を選択
   - 東京タワー点検フライト（デフォルト）
   - 富士山周遊フライト
   - 東京スカイツリー周遊
   - 金閣寺撮影フライト
   - カスタムフライトプラン（JSONファイルをインポート）

### ▶️ フライトプランの実行

1. フライトプランを選択すると、**シアン色のマーカーとライン**で飛行経路が表示されます
   - 🔵 **シアン色の円**: 各ウェイポイント
   - ━━ **シアン色の線**: 飛行経路
   - 📝 **ラベル**: "WP1: 離陸" などのフェーズ名

2. 画面下部の**「フライトプラン」セクション**で「開始」ボタンをクリック

3. **FPV（ドローン目線）カメラ**で自動的に飛行します
   - カメラは次のウェイポイントに向かって自動的に方向転換
   - Pitch 70度で前方下向きのドローン視点

### ⏸️ フライトの制御

- **一時停止**: 「一時停止」ボタンで飛行を一時停止
- **再開**: もう一度「開始」ボタンで再開
- **停止**: 完全に停止して初期状態に戻る

---

## リアルタイムログ

### 📊 ログの見方

画面下部に**リアルタイムログ**が表示されます。

#### ステータスバー（固定表示）

```
● フライト実行中  現在: 離陸 (1/10)
```

- **緑色の点（●）**: フライト実行中
- **黄色の点（●）**: 待機中
- **現在のフェーズ**: 今どのフェーズを実行中か
- **進捗**: (現在フェーズ/総フェーズ数)

#### ログエントリ

最新のログは以下の特徴で識別できます:
- ✅ **緑色の左ボーダー**: 最新エントリ
- ● **緑色の点**: 最新マーク
- 📜 **自動スクロール**: 常に最新ログが表示される

### 🔧 ログの操作

- **クリア**: すべてのログを削除
- **出力**: CSVファイルとしてダウンロード
- **表示切替**: ログリストの表示/非表示

---

## 高度な機能

### 📁 カスタムフライトプランのインポート

独自のフライトプランを作成して実行できます。

#### JSONフォーマット

```json
{
  "name": "マイフライトプラン",
  "description": "カスタムフライト",
  "created": "2024-01-15T10:00:00Z",
  "totalDuration": 30000,
  "phases": [
    {
      "phase": "離陸",
      "action": "開始地点から離陸",
      "duration": 3000,
      "position": [139.7454, 35.6586, 100],
      "pitch": 60,
      "bearing": 0,
      "zoom": 17
    },
    {
      "phase": "移動",
      "action": "次のポイントへ移動",
      "duration": 5000,
      "position": [139.7456, 35.6588, 150],
      "pitch": 70,
      "bearing": 45,
      "zoom": 18
    }
  ]
}
```

#### インポート手順

1. フライトプランドロップダウンで「カスタム」を選択
2. JSONファイルを選択
3. 自動的にウェイポイントとパスが可視化されます

### 🎯 データのエクスポート

- **フライトログ**: CSV形式でエクスポート可能
- **フライトプラン**: JSON形式で保存可能

---

## トラブルシューティング

### ❓ よくある質問

#### Q: フライトプランが動かない

**A**: 以下を確認してください:
1. フライトプランが正しく選択されているか
2. 「開始」ボタンをクリックしたか
3. ブラウザのコンソールでエラーが出ていないか

#### Q: ウェイポイントが表示されない

**A**: フライトプランを選択すると自動的に表示されます。表示されない場合:
1. ページをリロード
2. 別のフライトプランを選択してから再度選択

#### Q: ログが表示されない

**A**:
1. 画面下部のログパネルが展開されているか確認
2. 「表示切替」ボタンで表示/非表示を切り替え

#### Q: カメラの操作がうまくいかない

**A**:
1. フライト実行中は自動的にカメラが制御されます
2. 手動で操作したい場合は、フライトを一時停止してください

### 🐛 バグ報告

問題が解決しない場合は、以下の情報と共にお問い合わせください:
- 使用しているブラウザとバージョン
- 発生した問題の詳細
- エラーメッセージ（あれば）
- 再現手順

---

## 📱 推奨環境

- **ブラウザ**: Chrome, Firefox, Safari, Edge (最新版)
- **OS**: Windows, macOS, Linux
- **画面解像度**: 1280x720 以上
- **インターネット接続**: 必須（地図データの読み込みのため）

---

## 🎓 ヒント＆コツ

### 📸 ベストショットを撮る

1. フライトを一時停止
2. マウスで好きなアングルに調整
3. スクリーンショットを撮影

### 🗺️ 新しい場所を探索

1. 地図をパンして目的地を探す
2. 座標をメモ
3. カスタムフライトプランを作成

### ⚡ パフォーマンス向上

- 不要なブラウザタブを閉じる
- 2D表示に切り替えると軽くなる
- ログを定期的にクリア

---

**Version**: 2.2.2
**Last Updated**: 2025-01-15

🚁 Happy Flying!
